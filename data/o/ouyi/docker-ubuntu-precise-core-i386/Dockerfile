FROM scratch  
MAINTAINER Yi Ou <https://github.com/ouyi>  
ADD ubuntu-precise-core-cloudimg-i386-root.tar.gz /  
  
# docker doesn't officially support 32bit. to make "uname -m" work (which is  
# necessary at least for compile jobs), we need to prefix linux32 to each  
# command  
ENTRYPOINT ["/usr/bin/linux32", "--"]  
  
RUN echo "nameserver 8.8.8.8" | tee /etc/resolv.conf > /dev/null  
  
# a few minor docker-specific tweaks  
# see https://github.com/docker/docker/blob/master/contrib/mkimage/debootstrap  
RUN echo '#!/bin/sh' > /usr/sbin/policy-rc.d \  
&& echo 'exit 101' >> /usr/sbin/policy-rc.d \  
&& chmod +x /usr/sbin/policy-rc.d \  
\  
&& dpkg-divert --local \--rename --add /sbin/initctl \  
&& cp -a /usr/sbin/policy-rc.d /sbin/initctl \  
&& sed -i 's/^exit.*/exit 0/' /sbin/initctl \  
\  
&& echo 'force-unsafe-io' > /etc/dpkg/dpkg.cfg.d/docker-apt-speedup \  
\  
&& echo 'DPkg::Post-Invoke { "rm -f /var/cache/apt/archives/*.deb
/var/cache/apt/archives/partial/*.deb /var/cache/apt/*.bin || true"; };' >
/etc/apt/apt.conf.d/docker-clean \  
&& echo 'APT::Update::Post-Invoke { "rm -f /var/cache/apt/archives/*.deb
/var/cache/apt/archives/partial/*.deb /var/cache/apt/*.bin || true"; };' >>
/etc/apt/apt.conf.d/docker-clean \  
&& echo 'Dir::Cache::pkgcache ""; Dir::Cache::srcpkgcache "";' >>
/etc/apt/apt.conf.d/docker-clean \  
\  
&& echo 'Acquire::Languages "none";' > /etc/apt/apt.conf.d/docker-no-languages
\  
\  
&& echo 'Acquire::GzipIndexes "true"; Acquire::CompressionTypes::Order::
"gz";' > /etc/apt/apt.conf.d/docker-gzip-indexes  
  
# enable the universe  
RUN sed -i 's/^#\s*\\(deb.*universe\\)$/\1/g' /etc/apt/sources.list  
  
# overwrite this with 'CMD []' in a dependent Dockerfile  
CMD ["/bin/bash"]  

