  
##################################################  
# #  
# DO NOT EDIT THIS FILE MANUALLY #  
# AUTOMATICALLY CREATED WITH docker-builder.sh #  
# #  
##################################################  
  
  
FROM whatwedo/base:latest  
RUN apt-get update -y && \  
apt-get install -y postgresql postgresql-client  
USER postgres  
RUN echo "host all all 0.0.0.0/0 md5" >> /etc/postgresql/9.3/main/pg_hba.conf
&& \  
echo "listen_addresses='*'" >> /etc/postgresql/9.3/main/postgresql.conf  
USER root  
RUN echo "/etc/init.d/postgresql start" >> /bin/firstboot && \  
echo 'echo "alter user postgres password \0047${PG_ROOT_PASSWORD}\0047;" >
/pg-first-time.sql' >> /bin/firstboot && \  
echo 'su postgres -c "psql -f /pg-first-time.sql"' >> /bin/firstboot && \  
echo 'rm /pg-first-time.sql' >> /bin/firstboot && \  
echo "/etc/init.d/postgresql stop" >> /bin/firstboot  
COPY files/supervisord/postgres.conf /etc/supervisor/conf.d/postgres.conf  
RUN chown postgres /etc/ssl/private/ssl-cert-snakeoil.key && \  
sudo chown postgres /etc/ssl/certs/ssl-cert-snakeoil.pem && \  
apt-get autoremove -y && \  
apt-get clean -y && \  
rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*  
VOLUME ["/var/lib/postgresql"]  
EXPOSE 5432  
LABEL ch.whatwedo.image.base="whatwedo/postgres"  

